<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"  
    xmlns:h="http://java.sun.com/jsf/html"  
    xmlns:f="http://java.sun.com/jsf/core"  
    xmlns:ui="http://java.sun.com/jsf/facelets" 
    xmlns:p="http://primefaces.org/ui">  
         
	<h:head>  
		<link rel="stylesheet" type="text/css" href="#{request.contextPath}/css/common.css"/>
		
		<f:metadata>
 			<f:event listener="#{login.verifyUseLogin}" type="preRenderView"></f:event>
		</f:metadata>
	</h:head>

	<h:body>  
	
 		<div id="container" class="center">
	  		<div id="header" >
	  			<ui:include src="header.xhtml" />
	  		</div>
  		
	  		<div id="navigation">
                <ui:include src="global.xhtml" />           
            </div>
            
            <div id="menu" style="background-color:#FFFFFF;">
	            <ui:include src="menu.xhtml" />  
		    </div>
		    
		    <div id="main">
				<p:spacer width="20" height="20" />
				
			    <p:panel header="Uredi podatke certifikata" id="panel">
				    <h:form id="model_action">
				    	
				    	<p:growl id="messages" showDetail="true"/>  
				    
				    	<table>
		                	<tr>
						    	<td class="left"><h:outputLabel for="kod" value="Šifra:" /></td>  
						    	<td class="left">
						    		<p:inputText id="kod" value="#{editCertSif.kod}" label="Šifra" required="true" requiredMessage="Niste unijeli šifru" validatorMessage="Šifra može imati najviše 20 znakova">
						    			<f:validateLength minimum="1" maximum="20" />
									</p:inputText>						    	
						    	</td>
							</tr>
							<tr>				  
						    	<td class="left"><h:outputLabel for="naziv" value="Naziv:" /></td>
						    	<td class="left">
						    		<p:inputTextarea id="naziv" value="#{editCertSif.naziv}" rows="5" cols="30" maxlength="50" autoResize="false" required="true" requiredMessage="Niste unijeli odobreni broj" validatorMessage="Naziv može imati najviše 55 znakova">
						    			<f:validateLength minimum="1" maximum="55" />
						    		</p:inputTextarea>
						    	</td>
						  	</tr>
						  	<tr>				  
						    	<td class="left"><h:outputLabel for="komentar" value="Komentar:" /></td>
						    	<td class="left">
						    		<p:inputTextarea id="komentar" value="#{editCertSif.komentar}" rows="5" cols="30" maxlength="50" autoResize="false" required="true" requiredMessage="Niste unijeli komentar" validatorMessage="Komentar može imati najviše 55 znakova">
						    			<f:validateLength minimum="1" maximum="55" />
						    		</p:inputTextarea>  
						    	</td>
						  	</tr>
						  	<tr>	  
						    	<td class="left"><h:outputLabel for="mjera" value="Mjera:" /></td>
						    	<td class="left">
							        <p:selectOneMenu id="mjera" value="#{editCertSif.selectedMjera}" effect="fade" style="vertical-align:middle;">  
		            					<f:selectItems value="#{editCertSif.mjeraList}"/>
		        					</p:selectOneMenu> 
						    	</td>
					  		</tr>
					  		<tr>	  
						    	<td class="left"><h:outputLabel for="jezici" value="Jezici:" /></td>
						    	<td class="left">
					  				<p:selectCheckboxMenu id="jezici" value="#{editCertSif.selectedJezici}" label="Jezici">  
										<f:selectItems value="#{editCertSif.jezici}" />  
	   								</p:selectCheckboxMenu> 
	   							</td>
					  		</tr>
					  		<tr>				  
						    	<td class="left"><h:outputLabel for="drzava" value="Država:" /></td>
						    	<td class="left">
						    		<h:panelGroup id="drzPan">
						    			<p:inputText id="drzava" value="#{editCertSif.selectedDrzavaText}" label="Država" disabled="true" readonly="true"/>
						    		</h:panelGroup>
				    				<p:commandButton id="basic3" value="..." onclick="dlg1.show();" type="button"/>
						    	</td>
						  	</tr>
						  	<tr>				  
						    	<td class="left"><h:outputLabel for="tip" value="Tip certifikata:" /></td>
						    	<td class="left">
							  		<p:selectOneMenu id="tip" value="#{editCertSif.selectedCertTip}" effect="fade" style="vertical-align:middle;">  
		            					<f:selectItems value="#{editCertSif.certTipovi}"/>
		        					</p:selectOneMenu>
							  	</td>
						  	</tr>
						  	<tr>
						    	<td class="left"><h:outputLabel for="serijskibr" value="Serijski broj:" /></td>  
						    	<td class="left"><p:inputMask id="serijskibr" mask="999999" value="#{editCertSif.serijskiBroj}" label="Serijski broj" /></td>
							</tr>
							<tr>				  
						    	<td class="left"><h:outputLabel for="oznser" value="Oznaka serije:" /></td>
						    	<td class="left"><p:inputMask id="oznser" mask="a" value="#{editCertSif.oznakaSerije}" label="Oznaka serije"/></td>
						  	</tr>
						  	<tr>				  
						    	<td class="left"><h:outputLabel for="cijena" value="Cijena:" /></td>
						    	<td class="left">
						    		<p:inputText id="cijena" value="#{editCertSif.cijena}" label="Cijena" required="true" requiredMessage="Niste unijeli cijenu" validatorMessage="Neispravna cijena">
						    			<f:convertNumber minFractionDigits="2" />
						    		</p:inputText>
						    	</td>
						  	</tr>
						  	<tr>				  
						    	<td class="left"><h:outputLabel for="datumOd" value="Vrijedi od:" /></td>
						    	<td class="left">
						    		<p:calendar id="datumOd" value="#{editCertSif.datumOd}" label="Datum od" pattern="dd.MM.yyyy"/>
						    	</td>
						  	</tr>
						  	<tr>				  
						    	<td class="left"><h:outputLabel for="datumDo" value="Vrijedi do:" /></td>
						    	<td class="left">
						    		<p:calendar id="datumDo" value="#{editCertSif.datumDo}" label="Datum do" pattern="dd.MM.yyyy"/>
						    	</td>
						  	</tr>
						  	<tr>
						  		<td class="left"><h:outputLabel for="aktivan" value="Aktivan:" /></td>
						  		<td class="left"><p:selectBooleanCheckbox id="aktivan" value="#{editCertSif.status}" /></td>
						  	</tr>
					  	</table>
					    
					    <h:panelGroup id="command" layout="block" style="text-align:left !important; margin-top:5px;">
							<p:commandButton value="Spremi" icon="ui-icon-disk" action="#{editCertSif.add}" id="save" update=":panel, :uploadGroup, :uploadPanel, messages" disabled="#{editCertSif.showUpload == true and not editCertSif.edit}" style="text-align:left;"/>
							<p:commandButton value="Odustani" icon="ui-icon-close" actionListener="#{editCertSif.cancel}" immediate="true"/>
						</h:panelGroup>
						
				    </h:form>
			  	</p:panel>
		   		
		   		<p:spacer width="20" height="20" />
		   		
		   		<h:panelGroup id="uploadGroup">
				    <p:panel id="uploadPanel" header="Uredi model certifikata" >
				    	<h:form enctype="multipart/form-data" rendered="#{editCertSif.showUpload == true}">  
		  
						    <p:fileUpload fileUploadListener="#{editCertSif.handleFileUpload}"  
						            mode="advanced"   
						            update="messages1, :edit_cert"  
						            sizeLimit="5242880"   
						            allowTypes="/(\.|\/)(pdf)$/"
						            label="Učitajte model"
						            showButtons="false"
						            invalidSizeMessage="Model certifikata ne smije biti veći od 5 MB!"
                					invalidFileMessage="Model certifikata mora biti u PDF formatu!"
                					fileLimitMessage="Veličina modela je veća od 5MB"/>  
						  
						    <p:growl id="messages1" showDetail="true"/>  
						  
						</h:form> 
						<h:form id="edit_cert">
							
							<p:growl id="messages2" showDetail="true"/>  
						
							<h:panelGroup id="com_view" layout="block" style="text-align:left !important; margin-top:5px;">
								<p:commandButton id="downloadLink" value="Pregled" ajax="false" rendered="#{editCertSif.edit}" actionListener="#{editCertSif.prepareCertificateToDownload}" disabled="#{editCertSif.disablePregled}" update="uploadPanel">  
						    		<p:fileDownload value="#{editCertSif.fileDownload}" />  
								</p:commandButton>  
								<p:commandButton id="deleteCert" value="Obriši" onclick="deleteDialog.show()"/>  
							</h:panelGroup>		
							
						 	<p:confirmDialog id="deleteDialogW" message="Želite li obrisati model certifikata?" header="Brisanje modela certifikata" severity="alert" widgetVar="deleteDialog">            
								<p:commandButton id="confirm" value="Da" update="messages2, :edit_cert" oncomplete="deleteDialog.hide()" actionListener="#{editCertSif.delete}" />
								<p:commandButton id="decline" value="Ne" onclick="deleteDialog.hide()" type="button" />   
							</p:confirmDialog>
			
						</h:form> 
				    </p:panel>
		    	</h:panelGroup>
		    	
			    <p:dialog id="dialog1" header="Odabir države izvoza" widgetVar="dlg1" dynamic="true">   
				  	<p:panel header="Država" id="display1">
				    	<h:form prependId="false">  
						    <p:dataTable var="o" value="#{editCertSif.drzavaList}"
						    	paginator="true" rows="10"  
	            				paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"  
	            				paginatorPosition="bottom"
	            				emptyMessage="Nema podataka"
	            				rowKey="#{o.idDrzava}"
	            				filterEvent="enter"
	            				selectionMode="multiple"
	            				selection="#{editCertSif.selectedDrzava}"
	            				draggable="false"
	            				resizable="false">  
	            				
						        <p:column id="modelHeader" filterBy="#{o.idDrzava}" filterMatchMode="contains">  
						            <f:facet name="header">  
						                    ID  
						            </f:facet>  
						           	<h:outputText value="#{o.idDrzava}" style="float:left !important"/>  
						        </p:column>  
						  
						        <p:column filterBy="#{o.naziv}" filterMatchMode="contains">  
						            <f:facet name="header">  
						                    Naziv 
						            </f:facet>  
						            <h:outputText value="#{o.naziv}" style="float:left !important"/>  
						        </p:column>  
						        
						    </p:dataTable>  
						    <h:panelGroup id="cmd4close" layout="block" style="margin-top:5px; text-align:left !important">
						    	<p:commandButton value="Odaberi" actionListener="#{editCertSif.selectDrzava}" update=":#{p:component('drzava')}" oncomplete="dlg1.hide()" />  
							</h:panelGroup>
						</h:form>    
					</p:panel>  
				</p:dialog>
		    
           		<p:spacer width="20" height="20" />
				
            </div>
    	
           <div id="footer">
               <ui:include src="footer.xhtml" /> 
           </div>
            
        </div>    
 	</h:body>
</html>
